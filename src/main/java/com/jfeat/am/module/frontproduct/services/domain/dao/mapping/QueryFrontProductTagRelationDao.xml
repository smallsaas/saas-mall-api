<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jfeat.am.module.frontproduct.services.domain.dao.QueryFrontProductTagRelationDao">
    <sql id="Base_Column_List">
        t_product_tag_relation
        .
        id
        , t_product_tag_relation.tag_id AS tagId, t_product_tag_relation.product_id AS productId
    </sql>


    <select id="findProductTagRelationPage" resultType="FrontProductTagRelationRecord"
            parameterType="FrontProductTagRelationRecord">
        SELECT
        <include refid="Base_Column_List"/>
        FROM t_product_tag_relation
        WHERE 1=1
        <if test="record.id != null and record.id>0 ">
            AND t_product_tag_relation.id LIKE CONCAT('%',#{record.id},'%')
        </if>
        <if test="record.tagId != null and record.tagId>0 ">
            AND t_product_tag_relation.tag_id LIKE CONCAT('%',#{record.tagId},'%')
        </if>
        <if test="record.productId != null and record.productId>0 ">
            AND t_product_tag_relation.product_id LIKE CONCAT('%',#{record.productId},'%')
        </if>
        <if test="startTime != null">
            <![CDATA[AND t_product_tag_relation.start_time >= DATE(#{startTime})]]>
        </if>
        <if test="endTime != null">
            <![CDATA[AND t_product_tag_relation.end_time <= DATE(#{endTime)]]>
        </if>
        <!--
    <if test="search != null and search != ''">
        OR t_product_tag_relation.name LIKE CONCAT('%',#{search},'%')
    </if>
    -->
    </select>

    <select id="queryTagsByProductId" resultType="java.lang.Long">
        SELECT t_product_tag_relation.tag_id FROM t_product_tag_relation
        where t_product_tag_relation.product_id=#{id}
    </select>
</mapper>